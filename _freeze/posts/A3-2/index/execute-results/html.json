{
  "hash": "4bcc7446b1734c16e57ce4819f78b6a7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"pocketmoney\"\nformat:\n  html:\n    css: styles.css\n---\n\n\n\n------------------------------------------------------------------------\n\n<button>[Reading the Data]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_money <-read.csv(\"../../data/Pocket_money.csv\")\nprint(head(Pocket_money))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Sr.no    Name Gender Money_spent  X\n1     1   Aagam   Male         150 NA\n2     2  Aakash   Male         240 NA\n3     3 Aarushi Female         382 NA\n4     4 Abheeta Female          60 NA\n5     5 Adithya   Male          68 NA\n6     6  Aditya   Male         300 NA\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n## Research Question: Is there a significant difference in the average daily pocket money spent by boys and girls?\n\n------------------------------------------------------------------------\n\n<button>[Examining and Summarising]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(Pocket_money)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n    name     class levels  n missing\n1   Name character     82 82       0\n2 Gender character      2 82       0\n3      X   logical      0  0      82\n                                   distribution\n1 Aagam (1.2%), Aakash (1.2%) ...              \n2 Female (50%), Male (50%)                     \n3  (%)                                         \n\nquantitative variables:  \n         name   class min     Q1 median     Q3   max     mean         sd  n\n1       Sr.no integer   1  21.25   41.5  61.75    82  41.5000   23.81526 82\n2 Money_spent integer   0 100.00  264.5 596.25 13000 720.9634 1835.72169 82\n  missing\n1       0\n2       0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPocket_money %>% crosstable(Money_spent~Gender) %>% as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-97580eca{table-layout:auto;}.cl-975326bc{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-975326d0{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-97551c88{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-97551c92{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-97553290{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9755329a{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9755329b{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-9755329c{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-975532a4{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-97580eca'><thead><tr style=\"overflow-wrap:break-word;\"><th  rowspan=\"2\"class=\"cl-97553290\"><p class=\"cl-97551c88\"><span class=\"cl-975326bc\">label</span></p></th><th  rowspan=\"2\"class=\"cl-97553290\"><p class=\"cl-97551c88\"><span class=\"cl-975326bc\">variable</span></p></th><th  colspan=\"2\"class=\"cl-9755329a\"><p class=\"cl-97551c88\"><span class=\"cl-975326bc\">Gender</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-9755329b\"><p class=\"cl-97551c88\"><span class=\"cl-975326bc\">Female</span></p></th><th class=\"cl-9755329b\"><p class=\"cl-97551c88\"><span class=\"cl-975326bc\">Male</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td  rowspan=\"4\"class=\"cl-9755329c\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">Money_spent</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">Min / Max</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">0 / 1.3e+04</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">0 / 1.0e+04</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">Med [IQR]</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">280.0 [85.0;500.0]</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">250.0 [150.0;842.0]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">Mean (std)</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">693.3 (2035.8)</span></p></td><td class=\"cl-975532a4\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">748.6 (1636.5)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-9755329c\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">N (NA)</span></p></td><td class=\"cl-9755329c\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">41 (0)</span></p></td><td class=\"cl-9755329c\"><p class=\"cl-97551c92\"><span class=\"cl-975326d0\">41 (0)</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::t_test(Money_spent~Gender, data=Pocket_money)  %>% broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl>\n1    -55.3      693.      749.    -0.136   0.893      76.5    -868.      757.\n# ℹ 2 more variables: method <chr>, alternative <chr>\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n<button>[Data Munging]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n\npm_modified <- Pocket_money %>%\n  mutate(Gender = as.factor(Gender))\n```\n:::\n\n\n\n#### Qual variables- Gender\n\n#### Quant variable(s)- Money_spent\n\n------------------------------------------------------------------------\n\n<button>[Plotting Graphs]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npm_modified %>%\n  gf_density(\n    ~ Money_spent,\n    fill = ~ Gender,\n    alpha = 0.5,\n    title = \"Money Spent Densities\",\n    subtitle = \"Male vs Female\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##\npm_modified %>%\n  gf_boxplot(\n    Money_spent ~ Gender,\n    fill = ~ Gender,\n    alpha = 0.5,\n    title = \"Money Spent Box Plots\",\n    subtitle = \"Male vs Female\"\n  ) %>% gf_refine(scale_y_log10()) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in scale_y_log10(): log-10 transformation introduced infinite values.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 6 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\n##\npm_modified %>% count(Gender)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Gender  n\n1 Female 41\n2   Male 41\n```\n\n\n:::\n\n```{.r .cell-code}\npm_modified %>% \n  group_by(Gender) %>% \n  summarise(mean = mean(Money_spent))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  Gender  mean\n  <fct>  <dbl>\n1 Female  693.\n2 Male    749.\n```\n\n\n:::\n:::\n\n\n\n### Observations\n\n-   Outliers in both groups\n-   Based on median, females spend more money than males.\n-   In the density plot we can see that the distributions overlap to quite an extent, females spend more and there is more variability in male spending.\n\n------------------------------------------------------------------------\n\n<button>[Checking Assumptions]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n## Hypotheses:\n\n-   H0​: μ male spending​=μ female spending\n\n-   Ha​: μ male spending ≠ μ female spending\n\n## - Check for Normality\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npm_modified %>%\n  gf_density( ~ Money_spent,\n              fill = ~ Gender,\n              alpha = 0.5,\n              title = \"Money_spent by males and females\") %>%\n  gf_facet_grid(~ Gender) %>% \n  gf_fitdistr(dist = \"dnorm\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n-   both are right skewed and have sharp peaks...\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(pm_modified$Money_spent[pm_modified$Gender== \"Female\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  pm_modified$Money_spent[pm_modified$Gender == \"Female\"]\nW = 0.29606, p-value = 8.961e-13\n```\n\n\n:::\n:::\n\n\n\np value-\\> 0.0000000000008961\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(pm_modified$Money_spent[pm_modified$Gender== \"Male\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  pm_modified$Money_spent[pm_modified$Gender == \"Male\"]\nW = 0.40726, p-value = 1.136e-11\n```\n\n\n:::\n:::\n\n\n\np value-\\> 0.00000000001136\n\n#### *we can reject the null hypothesis and go forward with our alternative hypothesis based on w values, we can say data is not normally distributed*\n\n## - Check for Variances\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(Money_spent ~ Gender, data = pm_modified, \n         conf.int = TRUE, conf.level = 0.95) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMultiple parameters; naming those columns num.df, den.df\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 9\n  estimate num.df den.df statistic p.value conf.low conf.high method alternative\n     <dbl>  <int>  <int>     <dbl>   <dbl>    <dbl>     <dbl> <chr>  <chr>      \n1     1.55     40     40      1.55   0.172    0.825      2.90 F tes… two.sided  \n```\n\n\n:::\n:::\n\n\n\n#### *p value= 0.17 hence variances can be considered approximately equal. we do not reject the null hypothesis.*\n\n### -\n\n### Difference in Means:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobs_diff_pm <- diffmean(Money_spent ~ Gender, data = pm_modified) \nobs_diff_pm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndiffmean \n55.29268 \n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n## <button>[Inferences]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n# <u>-Using Parametric t.test</u>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::t_test(Money_spent ~Gender, data = pm_modified) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl>\n1    -55.3      693.      749.    -0.136   0.893      76.5    -868.      757.\n# ℹ 2 more variables: method <chr>, alternative <chr>\n```\n\n\n:::\n:::\n\n\n\n### with a high p value of 0.8, we can say that means of male and female pocket money spendings are not significantly different from one another.\n\n# <u>-Using Mann-Whitney </u>\n\n--data variables not distributed normally\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(Money_spent ~ Gender, data = pm_modified, \n            conf.int = TRUE, \n            conf.level = 0.95) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot\ncompute exact p-value with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot\ncompute exact confidence intervals with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 7\n  estimate statistic p.value conf.low conf.high method               alternative\n     <dbl>     <dbl>   <dbl>    <dbl>     <dbl> <chr>                <chr>      \n1    -55.0      746.   0.381    -180.      70.0 Wilcoxon rank sum t… two.sided  \n```\n\n\n:::\n:::\n\n\n\n### p value of 0.3, we fail to reject our null hypothesis. \n\n# <u>-Permutation </u>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist_pm <- \n  do(4999) * diffmean(data =pm_modified, Money_spent ~ shuffle(Gender))\nhead(null_dist_pm, n = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     diffmean\n1  -118.56098\n2  -695.34146\n3    81.68293\n4  -435.53659\n5   190.36585\n6   371.19512\n7  -679.73171\n8  -555.82927\n9   504.17073\n10  499.68293\n11 -636.80488\n12   39.39024\n13 -529.39024\n14 -517.04878\n15 -603.19512\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_histogram(data = null_dist_pm, ~ diffmean, bins = 25) %>%\n  gf_vline(xintercept = obs_diff_pm, \n           colour = \"blue\", linewidth = 2,\n           title = \"Null Distribution by Permutation\", \n           subtitle = \"Histogram\") %>% \n  gf_labs(x = \"Difference in Means\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\n###\ngf_ecdf(data = null_dist_pm, ~ diffmean, \n        linewidth = 2) %>%\n  gf_vline(xintercept = obs_diff_pm, \n           colour = \"blue\", linewidth = 1,\n           title = \"Null Distribution by Permutation\", \n           subtitle = \"Cumulative Density\") %>% \n  gf_labs(x = \"Difference in Means\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1-prop1(~ diffmean <= obs_diff_pm, data = null_dist_pm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n   0.4262 \n```\n\n\n:::\n:::\n\n\n\n### no strong difference between the groups being compared, female and male pocket money spemdings are approx same. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}