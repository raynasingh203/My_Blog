{
  "hash": "67791d8632b21f13eddf5ef03895dcb5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A-3 tips\"\nformat:\n  html:\n    css: styles.css\nORDER: 10\n---\n\n\n\n------------------------------------------------------------------------\n\n<button>[Reading the Data]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntip <-read.csv(\"../../data/tip.csv\")\nprint(head(tip))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Name Gender Food.preferance Tip\n1    Aanya Female             Veg   0\n2     Adit   Male             Veg   0\n3    Aditi Female             Veg  20\n4    Akash   Male         Non-veg   0\n5  Akshita Female         Non-veg   0\n6 Anandita Female         Non-veg   0\n```\n\n\n:::\n:::\n\n\n\n## Research Question: Is there a significant difference in the average tip amount given by non-vegetarians compared to vegetarians?\n\n------------------------------------------------------------------------\n\n<button>[Examining and Summarising]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninspect(tip)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\ncategorical variables:  \n             name     class levels  n missing\n1            Name character     58 60       0\n2          Gender character      2 60       0\n3 Food.preferance character      2 60       0\n                                   distribution\n1 Ananya (3.3%), Simran (3.3%) ...             \n2 Female (50%), Male (50%)                     \n3 Non-veg (50%), Veg (50%)                     \n\nquantitative variables:  \n  name   class min Q1 median Q3 max     mean       sd  n missing\n1  Tip integer   0  0      0 20 100 11.16667 17.83556 60       0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntip %>% crosstable(Tip~Food.preferance) %>% as_flextable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-7b812d9a{table-layout:auto;}.cl-7b7c3722{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7b7c3736{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-7b7e3964{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b7e396e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7b7e4f62{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b7e4f6c{background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 1.5pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b7e4f6d{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b7e4f6e{background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7b7e4f76{background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-7b812d9a'><thead><tr style=\"overflow-wrap:break-word;\"><th  rowspan=\"2\"class=\"cl-7b7e4f62\"><p class=\"cl-7b7e3964\"><span class=\"cl-7b7c3722\">label</span></p></th><th  rowspan=\"2\"class=\"cl-7b7e4f62\"><p class=\"cl-7b7e3964\"><span class=\"cl-7b7c3722\">variable</span></p></th><th  colspan=\"2\"class=\"cl-7b7e4f6c\"><p class=\"cl-7b7e3964\"><span class=\"cl-7b7c3722\">Food.preferance</span></p></th></tr><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-7b7e4f6d\"><p class=\"cl-7b7e3964\"><span class=\"cl-7b7c3722\">Non-veg</span></p></th><th class=\"cl-7b7e4f6d\"><p class=\"cl-7b7e3964\"><span class=\"cl-7b7c3722\">Veg</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td  rowspan=\"4\"class=\"cl-7b7e4f6e\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">Tip</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">Min / Max</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">0 / 50.0</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">0 / 100.0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">Med [IQR]</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">0 [0;20.0]</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">0 [0;20.0]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">Mean (std)</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">10.0 (12.9)</span></p></td><td class=\"cl-7b7e4f76\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">12.3 (21.9)</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-7b7e4f6e\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">N (NA)</span></p></td><td class=\"cl-7b7e4f6e\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">30 (0)</span></p></td><td class=\"cl-7b7e4f6e\"><p class=\"cl-7b7e396e\"><span class=\"cl-7b7c3736\">30 (0)</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::t_test(Tip~Food.preferance, data=tip)  %>% broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl>\n1    -2.33        10      12.3    -0.503   0.617      46.9    -11.7      6.99\n# ℹ 2 more variables: method <chr>, alternative <chr>\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::t_test(Tip~Gender, data=tip)  %>% broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl>\n1        2      12.2      10.2     0.431   0.668      55.8    -7.29      11.3\n# ℹ 2 more variables: method <chr>, alternative <chr>\n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n<button>[Data Munging]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\n\ntip_modified <- tip %>%\n  mutate(Food.preferance = as.factor(Food.preferance))\n```\n:::\n\n\n\n#### Qual variables- Gender, Food_Preferance (food_preference\\*)\n\n#### Quant variable(s)- Tip\n\n------------------------------------------------------------------------\n\n<button>[Plotting Graphs]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntip_modified %>% gf_histogram(~Tip|Food.preferance)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntip_modified %>%\n  gf_density(\n    ~ Tip,\n    fill = ~ Food.preferance,\n    alpha = 0.5,\n   \n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n### Observations\n\n-   Most of tips are clustered around the lower end ; Right skew in both cases.\n\n<!-- -->\n\n-   Tips above 50 are rare. One notable outlier in the vegetarian group.\n\n-   Vegetarians have a broader distribution\n\n<!-- -->\n\n-   Non-vegetarian tips are clustered around 10-25 range, they seem to tip more in this range.\n\n------------------------------------------------------------------------\n\n<button>[Checking Assumptions]{.button_top}</button>\n\n------------------------------------------------------------------------\n\n## Hypotheses:\n\n-   H0​: μ non-veg​=μ veg​\n\n-   Ha​: μ non-veg​ ≠ μ veg​\n\n## - Check for Normality\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntip_modified %>%\n  gf_density( ~ Tip,\n              fill = ~ Food.preferance,\n              alpha = 0.5,\n              title = \"Tips given by non-vegetarians and vegetarians\") %>%\n  gf_facet_grid(~ Food.preferance) %>% \n  gf_fitdistr(dist = \"dnorm\") \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\nNon-vegetarians- Right skewed distribution Vegetarians - Also right skewed but less skewed when compared with non-vegetarians\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(tip_modified$Tip[tip_modified$Food.preferance == \"Non-veg\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  tip_modified$Tip[tip_modified$Food.preferance == \"Non-veg\"]\nW = 0.71661, p-value = 2.747e-06\n```\n\n\n:::\n:::\n\n\n\np value= 0.000002747\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(tip_modified$Tip[tip_modified$Food.preferance == \"Veg\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  tip_modified$Tip[tip_modified$Food.preferance == \"Veg\"]\nW = 0.6286, p-value = 1.661e-07\n```\n\n\n:::\n:::\n\n\n\np value = 0.0000001661\n\n#### *p-value for both the groups (veg and non-veg) is less than 0.05, as a result we reject the null hypothesis, the data for both groups is not normally distributed.*\n\n## - Check for Variances\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(Tip ~ Food.preferance, data = tip_modified, \n         conf.int = TRUE, conf.level = 0.95) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nMultiple parameters; naming those columns num.df, den.df\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 9\n  estimate num.df den.df statistic p.value conf.low conf.high method alternative\n     <dbl>  <int>  <int>     <dbl>   <dbl>    <dbl>     <dbl> <chr>  <chr>      \n1    0.346     29     29     0.346 0.00554    0.165     0.726 F tes… two.sided  \n```\n\n\n:::\n:::\n\n\n\n#### 0.00554363 ***\\< 0.05, we reject the null hypothesis***\n\n# -\n\n### Difference in Means:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nobs_diff_tips <- diffmean(Tip ~ Food.preferance, data = tip_modified) \nobs_diff_tips\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndiffmean \n2.333333 \n```\n\n\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n## <button>[Inferences]{.button_top}</button>\n\n# <u>-Using Parametric t.test</u>\n\n## (\\*data is not Gaussian, variances are different)\n\n--a non-parametric test would be more suitable\n\n--let's check what we get regardless\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaic::t_test(Tip ~Food.preferance, data = tip_modified) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 10\n  estimate estimate1 estimate2 statistic p.value parameter conf.low conf.high\n     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>    <dbl>     <dbl>\n1    -2.33        10      12.3    -0.503   0.617      46.9    -11.7      6.99\n# ℹ 2 more variables: method <chr>, alternative <chr>\n```\n\n\n:::\n:::\n\n\n\n### **p value: 0.6**\n\n#### [we fail to reject the null hypothesis, no significant statistical difference between the means of non-vegetarian and vegetarian groups when it comes to tipping.]{style=\"color: #98B926;\"}\n\n------------------------------------------------------------------------\n\n# <u>-Permutation test</u>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnull_dist_Tip <- \n  do(4999) * diffmean(data =tip_modified, Tip ~ shuffle(Food.preferance))\nhead(null_dist_Tip, n = 15)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    diffmean\n1   3.666667\n2   5.000000\n3  -2.666667\n4  -6.666667\n5   3.000000\n6   7.000000\n7  -3.000000\n8   4.000000\n9  -3.333333\n10 -8.333333\n11 -3.333333\n12  4.666667\n13  4.333333\n14 -1.000000\n15 -6.000000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_histogram(data = null_dist_Tip, ~ diffmean, bins = 25) %>%\n  gf_vline(xintercept = obs_diff_tips, \n           colour = \"pink\", linewidth = 1,\n           title = \"Null Distribution by Permutation\", \n           subtitle = \"Histogram\") %>% \n  gf_labs(x = \"Difference in Means\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\n###\ngf_ecdf(data = null_dist_Tip, ~ diffmean, \n        linewidth = 1) %>%\n  gf_vline(xintercept = obs_diff_tips, \n           colour = \"pink\", linewidth = 1,\n           title = \"Null Distribution by Permutation\", \n           subtitle = \"Cumulative Density\") %>% \n  gf_labs(x = \"Difference in Means\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n1-prop1(~ diffmean <= obs_diff_tips, data = null_dist_Tip)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nprop_TRUE \n   0.2968 \n```\n\n\n:::\n:::\n\n\n\n### The observed difference in tips is not beyond anythimg that we could generate with permutations; therefore, there is again no significant different in tips between the vegetarian and non vegetarian groups. We fail to reject the null hypothesis.\n\n#### --------------------------\n\n# <u>-Mann-Whitney Test</u>\n\n—data is not normally distributed (not Gaussian), and the variances of the two groups are significantly different. This indicates that the assumption of normality is not satisfied, while the assumption of equal variances is satisfied.\n\n-- we can do Wilcox.test (test of mean ranks)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(Tip ~ Food.preferance, data = tip_modified, \n            conf.int = TRUE, \n            conf.level = 0.95) %>% \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot\ncompute exact p-value with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot\ncompute exact confidence intervals with ties\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 7\n   estimate statistic p.value   conf.low   conf.high method          alternative\n      <dbl>     <dbl>   <dbl>      <dbl>       <dbl> <chr>           <chr>      \n1 0.0000372       463   0.833 -0.0000335 0.000000989 Wilcoxon rank … two.sided  \n```\n\n\n:::\n:::\n\n\n\n#### p value= 0.8, we fail to reject our null hypothesis again.\n\n#### hence, there truly is no significant statistical difference between the means of non-veg and veg groups; tips given by both are similar enough.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}